<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Apply to Carolina Lumper Service (CLS)</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="assets/CLS-favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">
  <style>
    /* Centering the iframe */
    .form-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 80vh;
      text-align: center;
    }

    iframe {
      border: none;
      width: 100%;
      max-width: 800px;
      /* Adjust for your layout */
      height: 2400px;
      /* Adjust to fit content without iframe scrollbar */
    }
    @media (max-width: 768px) {
      iframe {
        height: 3200px;
      }
    }

    body {
      margin: 0;
    }

    .language-toggle {
      margin: 10px;
      text-align: center;
    }

    .language-toggle button {
      margin: 5px;
      padding: 10px;
      font-size: 14px;
      cursor: pointer;
    }
  </style>
  <script>
    const MESSAGES = {
      en: { sending: "Sending...", success: "Thanks. We received your application.", error: "Error. Please try again." },
      es: { sending: "Enviando...", success: "Gracias. Recibimos su solicitud.", error: "Error. Intente de nuevo." },
      pt: { sending: "Enviando...", success: "Obrigado. Recebemos sua candidatura.", error: "Erro. Tente novamente." }
    };

    function adjustNavbarFontSize() {
      const navLinks = document.querySelector('.nav-links');
      const links = navLinks.querySelectorAll('a');
      const maxWidth = navLinks.offsetWidth;

      let totalWidth = 0;
      for (const link of links) {
        totalWidth += link.offsetWidth;
      }

      if (totalWidth > maxWidth) {
        const scaleFactor = maxWidth / totalWidth;
        navLinks.style.fontSize = scaleFactor * 0.9 + 'em';
      } else {
        navLinks.style.fontSize = '0.9em';
      }
    }

    function applyPlaceholders(lang) {
      document.querySelectorAll('[data-ph-en]').forEach(el => {
        const val =
          lang === 'es' ? el.getAttribute('data-ph-es') :
          lang === 'pt' ? el.getAttribute('data-ph-pt') :
          el.getAttribute('data-ph-en');
        if (val) el.setAttribute('placeholder', val);
      });
    }

    function switchLanguage(lang) {
      const elements = document.querySelectorAll("[data-en], [data-es], [data-pt]");
      elements.forEach(element => {
        element.innerHTML = lang === "es" ? element.getAttribute("data-es") :
          lang === "pt" ? element.getAttribute("data-pt") :
            element.getAttribute("data-en");
      });
      const form = document.getElementById('cls-apply');
      if (form) {
        const langField = form.querySelector('input[name="ui_lang"]');
        if (langField) langField.value = lang;
      }
      applyPlaceholders(lang);
      adjustNavbarFontSize();
    }

    document.addEventListener("DOMContentLoaded", () => {
      const userLang = navigator.language || navigator.userLanguage || 'en';
      const lang = userLang.startsWith("es") ? "es" : userLang.startsWith("pt") ? "pt" : "en";
      switchLanguage(lang);
      adjustNavbarFontSize();

      const form = document.getElementById('cls-apply');
      if (form) {
        const startedAt = form.querySelector('input[name="startedAt"]');
        if (startedAt) startedAt.value = String(Date.now());

        const statusEl = document.getElementById('status');

        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          const currentLang = form.querySelector('input[name="ui_lang"]')?.value || 'en';
          if (statusEl) statusEl.textContent = MESSAGES[currentLang].sending;

          try {
            const body = new URLSearchParams(new FormData(form));
            const res = await fetch(form.action, { method: 'POST', body });
            let msg = MESSAGES[currentLang][res.ok ? 'success' : 'error'];
            try {
              const j = await res.json();
              if (j && j.message) msg = j.message;
            } catch {}
            if (statusEl) statusEl.textContent = msg;
            if (res.ok) {
              form.reset();
              const langField = form.querySelector('input[name="ui_lang"]');
              if (langField) langField.value = currentLang;
              applyPlaceholders(currentLang);
            }
          } catch (err) {
            if (statusEl) statusEl.textContent = MESSAGES[currentLang].error;
          }
        });
      }
    });
  </script>
</head>

<body>
  <!-- Navigation Bar -->
  <nav class="navbar">
    <div class="logo-container">
      <a href="index.html" class="logo-link">
        <img src="assets/CLS_Nav_Logo.png" alt="CLS Logo" class="logo">
      </a>
      <a href="index.html" class="company-name">Carolina Lumper Service</a>
    </div>
    
    <ul class="nav-links">
      <li><a href="index.html" data-en="Home" data-es="Inicio" data-pt="Início">Home</a></li>
      <li><a href="about.html" data-en="About Us" data-es="Sobre Nosotros" data-pt="Sobre Nós">About Us</a></li>
      <li><a href="services.html" data-en="Services" data-es="Servicios" data-pt="Serviços">Services</a></li>
      <li><a href="contact.html" data-en="Contact" data-es="Contacto" data-pt="Contato">Contact</a></li>
      <li><a href="apply.html" class="active" data-en="Apply" data-es="Solicitar" data-pt="Candidatar">Apply</a></li>
    </ul>
  </nav>

  <!-- Hero Section -->
  <header class="hero">
    <div class="hero-content container text-center">
      <h2 data-en="Join the CLS Team" data-es="Únete al Equipo CLS" data-pt="Junte-se à Equipe CLS">Join the CLS Team</h2>
      <p data-en="We are looking for motivated individuals to join our team. Fill out the application below to get started!" 
         data-es="Estamos buscando personas motivadas para unirse a nuestro equipo. ¡Complete la solicitud abajo para comenzar!"
         data-pt="Estamos procurando pessoas motivadas para se juntar à nossa equipe. Preencha o formulário abaixo para começar!">
         We are looking for motivated individuals to join our team. Fill out the application below to get started!
      </p>
    </div>
    <div class="hero-image">
      <img src="assets/CLS-Cover-01web.webp" alt="Hero Banner" class="banner-image">
      <div class="blur-overlay"></div>
    </div>
  </header>

  <!-- Application Section -->
  <section id="apply">
    <div class="form-container">
      <h2 data-en="Apply for a Position" data-es="Solicitar un Puesto" data-pt="Candidatar-se a uma Posição">Apply for a Position</h2>
      <p data-en="Interested in joining our team? Complete the form below:" data-es="¿Interesado en unirte a nuestro equipo? Completa el formulario abajo:" data-pt="Interessado em se juntar à nossa equipe? Complete o formulário abaixo:">
        Interested in joining our team? Complete the form below:
      </p>

      <!-- Custom form (replaces Google Form iframe) -->
      <form id="cls-apply"
            action="https://script.google.com/macros/s/AKfycbxdD80YrBa6wa271_TtCpwWnQJbQfeRjZVe0iRkAdO36D_t3E44foSn11IdCEq1iJ6OSg/exec"
            method="POST" novalidate>
        <input type="hidden" name="startedAt" value="">
        <input type="hidden" name="ui_lang" value="en">
        <div style="position:absolute;left:-10000px" aria-hidden="true">
          <label data-en="Website" data-es="Sitio web" data-pt="Site">Website
            <input name="website" tabindex="-1" autocomplete="off">
          </label>
        </div>

        <div>
          <label data-en="First name" data-es="Nombre" data-pt="Nome">
            <input name="first_name" required minlength="2" autocomplete="given-name"
                   data-ph-en="First name" data-ph-es="Nombre" data-ph-pt="Nome">
          </label>
        </div>
        <div>
          <label data-en="Last name" data-es="Apellido" data-pt="Sobrenome">
            <input name="last_name" required minlength="2" autocomplete="family-name"
                   data-ph-en="Last name" data-ph-es="Apellido" data-ph-pt="Sobrenome">
          </label>
        </div>
        <div>
          <label data-en="Email" data-es="Correo electrónico" data-pt="E-mail">
            <input name="email" type="email" required autocomplete="email"
                   data-ph-en="you@example.com" data-ph-es="tu@ejemplo.com" data-ph-pt="voce@exemplo.com">
          </label>
        </div>
        <div>
          <label data-en="Phone" data-es="Teléfono" data-pt="Telefone">
            <input name="phone" inputmode="tel" autocomplete="tel"
                   data-ph-en="(555) 555-1212" data-ph-es="(555) 555-1212" data-ph-pt="(11) 5555-1212">
          </label>
        </div>
        <div>
          <label data-en="City" data-es="Ciudad" data-pt="Cidade">
            <input name="city" autocomplete="address-level2"
                   data-ph-en="City" data-ph-es="Ciudad" data-ph-pt="Cidade">
          </label>
        </div>
        <div>
          <label data-en="State" data-es="Estado" data-pt="Estado">
            <input name="state" autocomplete="address-level1"
                   data-ph-en="State or Province" data-ph-es="Estado o provincia" data-ph-pt="Estado ou província">
          </label>
        </div>
        <div>
          <label data-en="Preferred shift" data-es="Turno preferido" data-pt="Turno preferido">
            <select name="shift_preference">
              <option value=""></option>
              <option value="Day" data-en="Day" data-es="Diurno" data-pt="Diurno">Day</option>
              <option value="Evening" data-en="Evening" data-es="Vespertino" data-pt="Vespertino">Evening</option>
              <option value="Night" data-en="Night" data-es="Nocturno" data-pt="Noturno">Night</option>
              <option value="Weekends" data-en="Weekends" data-es="Fines de semana" data-pt="Fins de semana">Weekends</option>
            </select>
          </label>
        </div>
        <div>
          <label data-en="Experience level" data-es="Experiencia" data-pt="Experiência">
            <select name="experience_level">
              <option value=""></option>
              <option value="None" data-en="None" data-es="Ninguna" data-pt="Nenhuma">None</option>
              <option value="0–6 months" data-en="0–6 months" data-es="0–6 meses" data-pt="0–6 meses">0–6 months</option>
              <option value="6–12 months" data-en="6–12 months" data-es="6–12 meses" data-pt="6–12 meses">6–12 months</option>
              <option value="1+ years" data-en="1+ years" data-es="Más de 1 año" data-pt="1+ anos">1+ years</option>
            </select>
          </label>
        </div>
        <div>
          <label data-en="Work authorization" data-es="Autorización de trabajo" data-pt="Autorização de trabalho">
            <select name="work_authorization">
              <option value=""></option>
              <option value="Citizen" data-en="Citizen" data-es="Ciudadano" data-pt="Cidadão">Citizen</option>
              <option value="Permanent Resident" data-en="Permanent Resident" data-es="Residente permanente" data-pt="Residente permanente">Permanent Resident</option>
              <option value="Work Visa" data-en="Work Visa" data-es="Visa de trabajo" data-pt="Visto de trabalho">Work Visa</option>
              <option value="Other" data-en="Other" data-es="Otro" data-pt="Outro">Other</option>
            </select>
          </label>
        </div>
        <div>
          <label data-en="Preferred location" data-es="Ubicación preferida" data-pt="Local preferido">
            <input name="preferred_location" data-ph-en="Example: CLT-DC1" data-ph-es="Ejemplo: CLT-DC1" data-ph-pt="Ex.: CLT-DC1">
          </label>
        </div>
        <div>
          <label data-en="Notes" data-es="Notas" data-pt="Observações">
            <textarea name="notes" rows="4"
              data-ph-en="Forklift certs, availability, locations"
              data-ph-es="Certificados, disponibilidad, ubicaciones"
              data-ph-pt="Certificados, disponibilidade, locais"></textarea>
          </label>
        </div>

        <label><input type="checkbox" name="consent" required>
          <span data-en="I agree to the privacy policy"
                data-es="Acepto la política de privacidad"
                data-pt="Concordo com a política de privacidade">I agree to the privacy policy</span>
        </label>

        <button type="submit" data-en="Submit application" data-es="Enviar solicitud" data-pt="Enviar candidatura">Submit application</button>
        <p id="status" role="status" aria-live="polite"></p>
      </form>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <p data-en="© 2024 Carolina Lumper Service. All rights reserved." data-es="© 2024 Carolina Lumper Service. Todos los derechos reservados." data-pt="© 2024 Carolina Lumper Service. Todos os direitos reservados.">© 2024 Carolina Lumper Service. All rights reserved.</p>
    <div class="footer-icons">
      <a href="https://www.facebook.com/profile.php?id=61569872795390"><img src="assets/facebook-icon.png" alt="Facebook"></a>
      <a href="#"><img src="assets/linkedin-icon.png" alt="LinkedIn"></a>
    </div>
    <div class="language-toggle">
      <button onclick="switchLanguage('en')">English</button>
      <button onclick="switchLanguage('es')">Español</button>
      <button onclick="switchLanguage('pt')">Português</button>
    </div>
  </footer>
</body>
</html>
