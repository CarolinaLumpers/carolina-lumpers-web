<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contact / Quote Request | Carolina Lumper Service (CLS)</title>

  <!-- Core styles -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/forms.css">
  <link rel="icon" type="image/png" href="assets/CLS-favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">
  <script src="js/script.js" defer></script>
</head>

<body data-page="contact">
  <!-- Navbar -->
  <div id="navbar-container"></div>

  <!-- Hero -->
  <header class="hero">
    <div class="hero-content">
      <h2>Request a Quote or Contact CLS</h2>
      <p>We're ready to support your freight operation — request a quote today or reach out to our team.</p>
    </div>
    <div class="hero-image">
      <img src="assets/CLS-Cover-01web.webp" alt="Hero Banner" class="banner-image">
      <div class="blur-overlay"></div>
    </div>
  </header>

  <!-- Main -->
  <main class="container">
    <!-- Contact Info -->
    <section id="contact-info" class="section-container">
      <h2>Get in Touch</h2>
      <p>Email us at <a href="mailto:info@carolinalumpers.com">info@carolinalumpers.com</a> or call <a href="tel:+18287810002">(828) 781-0002</a>.</p>
      <p><strong>Business Hours:</strong></p>
      <ul>
        <li>Mon–Fri: 8:00 AM – 6:00 PM</li>
        <li>Sat: 9:00 AM – 3:00 PM</li>
        <li>Sun: Closed</li>
      </ul>
    </section>

    <!-- Quote Request Form -->
    <section id="quote-request" class="section-container">
      <h2>Request a Quote</h2>
      <p>Fill out the quick form below, and our team will follow up with scheduling and pricing details.</p>

      <div class="progress" aria-live="polite">
        <div class="progress-top">
          <strong id="stepLabel">Step 1 of 7</strong>
          <span id="stepName">Contact Information</span>
        </div>
        <div class="bar"><div class="bar-fill" id="barFill"></div></div>
        <div class="steps" id="stepsDots"></div>
      </div>

      <form id="quoteForm" novalidate>
          <!-- 1. Contact Information -->
          <section class="form-step active" data-title="Contact Information">
            <div class="grid grid-2">
              <div class="field">
                <label>Company Name (if applicable)</label>
                <input name="companyName" type="text" autocomplete="organization">
              </div>
              <div class="field">
                <label>Contact Person / Title</label>
                <input name="contactName" type="text" autocomplete="name">
              </div>
              <div class="field">
                <label class="required">Phone Number</label>
                <input name="phone" type="tel" autocomplete="tel" required>
                <div class="error">Please enter a phone number.</div>
              </div>
              <div class="field">
                <label class="required">Email Address</label>
                <input name="email" type="email" autocomplete="email" required>
                <div class="error">Please enter a valid email.</div>
              </div>
              <div class="field">
                <label>Preferred Contact Method</label>
                <select name="preferredContact">
                  <option value="">Select…</option>
                  <option>Phone</option>
                  <option>Email</option>
                  <option>Text</option>
                </select>
              </div>
              <div class="field">
                <label>How did you hear about us? (optional)</label>
                <input name="referral" type="text" placeholder="Google, referral, carrier rep, etc.">
              </div>
            </div>
          </section>

          <!-- 2. Service Details -->
          <section class="form-step" data-title="Service Details">
            <div class="mb8"><label>Type of Service Needed (check all that apply)</label></div>
            <div class="checklist">
              <label class="chip"><input type="checkbox" name="services" value="Lumper">Lumper</label>
              <label class="chip"><input type="checkbox" name="services" value="Unloading">Unloading</label>
              <label class="chip"><input type="checkbox" name="services" value="Loading">Loading</label>
              <label class="chip"><input type="checkbox" name="services" value="Pallet Breakdown">Pallet Breakdown</label>
              <label class="chip"><input type="checkbox" name="services" value="Repacking">Repacking</label>
              <label class="chip"><input type="checkbox" name="services" value="Cross-Docking">Cross-Docking</label>
              <label class="chip"><input type="checkbox" name="services" value="Sorting">Sorting</label>
              <label class="chip"><input type="checkbox" name="services" value="Other">Other</label>
            </div>

            <div class="grid grid-2" style="margin-top:12px">
              <div class="field">
                <label>Frequency of Service</label>
                <select name="frequency">
                  <option value="">Select…</option>
                  <option>One-time</option>
                  <option>Daily</option>
                  <option>Weekly</option>
                  <option>Monthly</option>
                  <option>Seasonal</option>
                </select>
              </div>
              <div class="field">
                <label>Expected Start Date</label>
                <input name="startDate" type="date">
              </div>
              <div class="field">
                <label>Shift or Time Window</label>
                <select name="shift">
                  <option value="">Select…</option>
                  <option>Morning</option>
                  <option>Afternoon</option>
                  <option>Night</option>
                  <option>Flexible</option>
                </select>
              </div>
              <div class="field">
                <label>Estimated Duration (optional)</label>
                <input name="duration" type="text" placeholder="e.g., 4 hours, all shift">
              </div>
              <div class="field">
                <label>Ongoing Account or Trial Job? (optional)</label>
                <input name="ongoingOrTrial" type="text" placeholder="Ongoing, pilot, or one-off"/>
              </div>
            </div>
          </section>

          <!-- 3. Location Details -->
          <section class="form-step" data-title="Location Details">
            <div class="grid grid-2">
              <div class="field">
                <label class="required">Facility Name / Warehouse</label>
                <input name="facility" type="text" required>
                <div class="error">Facility name is required.</div>
              </div>
              <div class="field">
                <label class="required">Address</label>
                <input name="address" type="text" required placeholder="Street, City, State, ZIP">
                <div class="error">Address is required.</div>
              </div>
              <div class="field">
                <label>Dock or Bay Number (if known)</label>
                <input name="dock" type="text">
              </div>
              <div class="field">
                <label>Entry or Safety Requirements</label>
                <input name="entryRequirements" type="text" placeholder="Badges, PPE, safety videos, etc.">
              </div>
              <div class="field">
                <label>On-Site Contact Name & Phone</label>
                <input name="onsiteContact" type="text" placeholder="Name, phone">
              </div>
            </div>
          </section>

          <!-- 4. Volume & Workforce -->
          <section class="form-step" data-title="Volume & Workforce">
            <div class="grid grid-2">
              <div class="field">
                <label>Average Number of Loads</label>
                <input name="avgLoads" type="text" placeholder="per Day / Week">
              </div>
              <div class="field">
                <label>Type of Freight</label>
                <select name="freight">
                  <option value="">Select…</option>
                  <option>Palletized</option>
                  <option>Floor-Loaded</option>
                  <option>Mixed</option>
                </select>
              </div>
              <div class="field">
                <label>Estimated Number of Workers Needed (if known)</label>
                <input name="workersNeeded" type="number" min="1" step="1" placeholder="e.g., 4">
              </div>
              <div class="field">
                <label>Special Equipment Required</label>
                <input name="equipment" type="text" placeholder="Pallet Jack, Forklift, PPE, Other">
              </div>
              <div class="field">
                <label>Average Load Weight or Container Size (optional)</label>
                <input name="avgWeight" type="text" placeholder="e.g., 40' HC, 20k lbs">
              </div>
            </div>
          </section>

          <!-- 5. Billing Information -->
          <section class="form-step" data-title="Billing Information">
            <div class="grid grid-2">
              <div class="field">
                <label>Billing Contact Name & Email</label>
                <input name="billingContact" type="text" placeholder="Name, email">
              </div>
              <div class="field">
                <label>Preferred Billing Method</label>
                <select name="billingMethod">
                  <option value="">Select…</option>
                  <option>Email</option>
                  <option>Portal</option>
                  <option>Paper</option>
                </select>
              </div>
              <div class="field">
                <label>Payment Terms or Requirements</label>
                <input name="paymentTerms" type="text" placeholder="Net 15, Net 30, ACH preferred">
              </div>
              <div class="field">
                <label>Accounts Payable Address (if different)</label>
                <input name="apAddress" type="text">
              </div>
              <div class="field">
                <label>Tax Exemption Certificate (if applicable)</label>
                <input name="taxExempt" type="text" placeholder="Number / note">
              </div>
              <div class="field">
                <label>Require W9 or insurance certificate before service?</label>
                <select name="requireDocs">
                  <option value="">Select…</option>
                  <option>Yes</option>
                  <option>No</option>
                  <option>Maybe</option>
                </select>
              </div>
            </div>
          </section>

          <!-- 6. Additional Notes -->
          <section class="form-step" data-title="Additional Notes">
            <div class="field">
              <label>Special Instructions or Comments</label>
              <textarea name="notes" placeholder="Include shift overlap, badge requirements, truck staging details…"></textarea>
            </div>
            <div class="grid grid-2" style="margin-top:12px">
              <label class="chip"><input type="checkbox" name="sendRateSheet" value="Yes">Please send me a standard rate sheet</label>
              <label class="chip"><input type="checkbox" name="siteVisit" value="Yes">Request a site visit before quoting</label>
            </div>
          </section>

          <!-- 7. Confirmation & Authorization -->
          <section class="form-step" data-title="Confirmation">
            <div class="grid grid-2" style="margin-top:12px">
              <div class="field">
                <label>Signature / Name</label>
                <input name="signature" type="text" placeholder="Type your full name">
              </div>
              <div class="field">
                <label>Date</label>
                <input name="signatureDate" type="date">
              </div>
            </div>
            <p class="helper">By submitting, you authorize Carolina Lumper Service to contact you for scheduling and provide a written quote.</p>
          </section>
          
          <!-- Form Navigation -->
          <div class="form-nav">
            <button type="button" id="backBtn" class="btn btn-secondary" style="display:none;">← Back</button>
            <button type="button" id="nextBtn" class="btn btn-primary">Next →</button>
            <button type="submit" id="submitBtn" class="btn btn-primary" style="display:none;">Submit Request</button>
          </div>
      </form>
      
      <!-- Success Message -->
      <div id="successMsg" class="success" style="display:none;">✅ Thanks! Your request has been submitted.</div>
    </section>
  </main>

  <!-- Footer -->
  <footer>
    <p>© 2024 Carolina Lumper Service. All rights reserved.</p>
    <div class="footer-icons">
      <a href="https://www.facebook.com/profile.php?id=61569872795390"><img src="assets/facebook-icon.png" alt="Facebook"></a>
      <a href="#"><img src="assets/linkedin-icon.png" alt="LinkedIn"></a>
    </div>
  </footer>

  <!-- Form Logic -->
  <script>
  (function(){
    const form = document.getElementById('quoteForm');
    const steps = Array.from(form.querySelectorAll('.form-step'));
    const stepLabel = document.getElementById('stepLabel');
    const stepName = document.getElementById('stepName');
    const barFill = document.getElementById('barFill');
    const backBtn = document.getElementById('backBtn');
    const nextBtn = document.getElementById('nextBtn');
    const submitBtn = document.getElementById('submitBtn');
    const successMsg = document.getElementById('successMsg');
    const summaryList = document.getElementById('summaryList');
    const stepsDots = document.getElementById('stepsDots');
    const saveDraftBtn = document.getElementById('saveDraftBtn');

    let current = 0;
    const total = steps.length;

    const titles = steps.map(s => s.dataset.title || 'Step');
    titles.forEach((t,i)=>{
      const dot=document.createElement('button');
      dot.type='button';
      dot.className='step-dot';
      dot.textContent=(i+1);
      dot.title=t;
      dot.addEventListener('click',()=>go(i,true));
      stepsDots.appendChild(dot);
    });

    function updateProgress(){
      stepLabel.textContent = `Step ${current+1} of ${total}`;
      stepName.textContent = titles[current];
      barFill.style.transform = `scaleX(${(current+1)/total})`;
      stepsDots.querySelectorAll('.step-dot').forEach((d,i)=>{
        d.setAttribute('aria-current', i===current ? 'step' : 'false');
        d.classList.toggle('done', i<current);
      });
      backBtn.style.visibility = current === 0 ? 'hidden' : 'visible';
      nextBtn.style.display = current === total-1 ? 'none' : 'inline-flex';
      submitBtn.style.display = current === total-1 ? 'inline-flex' : 'none';
    }

    function go(n, skip=false){
      if (!skip && n>current && !validateStep(current)) return;
      steps[current].classList.remove('active');
      current = Math.max(0, Math.min(total-1,n));
      steps[current].classList.add('active');
      if (current === total-1) buildSummary();
      updateProgress();
      document.getElementById('quote-request').scrollIntoView({behavior:'smooth'});
    }

    function next(){ go(current+1); }
    function back(){ go(current-1,true); }

    function validateEmail(v){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v); }
    function validateStep(idx){
      const stepEl = steps[idx];
      const fields = stepEl.querySelectorAll('.field');
      fields.forEach(f=>f.classList.remove('invalid'));
      let ok = true;

      if (idx===0){
        const phone = stepEl.querySelector('input[name="phone"]');
        const email = stepEl.querySelector('input[name="email"]');
        if (!phone.value.trim()) { phone.parentElement.classList.add('invalid'); ok=false; }
        if (!validateEmail(email.value)) { email.parentElement.classList.add('invalid'); ok=false; }
      }
      if (idx===2){
        const facility = stepEl.querySelector('input[name="facility"]');
        const address = stepEl.querySelector('input[name="address"]');
        if (!facility.value.trim()) { facility.parentElement.classList.add('invalid'); ok=false; }
        if (!address.value.trim()) { address.parentElement.classList.add('invalid'); ok=false; }
      }
      return ok;
    }

    function getAllValues(){
      const fd = new FormData(form);
      const services = Array.from(form.querySelectorAll('input[name="services"]:checked')).map(i=>i.value);
      if (services.length) fd.set('services', services.join(', '));
      return { fd };
    }

    async function submitForm(e){
      e.preventDefault();
      if (!validateStep(current)) return;

      const { fd } = getAllValues();
      fd.append('startedAt', Date.now());
      fd.append('formType', 'quote-request');

      try {
        const API_BASE = "https://script.google.com/a/macros/carolinalumpers.com/s/AKfycbwWsIE5HwHzfZX2V6kh8SvUXZMhthPeEY3I1p0oGbdU3tp3-T6Q7tgEEgLJ-p9VZu1o/exec";
        const res = await fetch(API_BASE, { method:'POST', body: fd });
        if (res.ok) {
          successMsg.classList.add('show');
          submitBtn.disabled = true;
          nextBtn.disabled = true;
          backBtn.disabled = true;
          localStorage.removeItem('CLS_QUOTE_DRAFT');
        } else throw new Error();
      } catch {
        successMsg.textContent = '⚠️ Error submitting request. Please try again.';
        successMsg.classList.add('show');
      }
    }

    document.getElementById('nextBtn').addEventListener('click', next);
    document.getElementById('backBtn').addEventListener('click', back);
    document.getElementById('quoteForm').addEventListener('submit', submitForm);

    steps[0].classList.add('active');
    updateProgress();
  })();
  </script>
</body>
</html>
