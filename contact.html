<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contact / Quote Request | Carolina Lumper Service (CLS)</title>

  <!-- Core styles -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/forms.css">
  <link rel="icon" type="image/png" href="assets/CLS-favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">
  <script src="js/script.js" defer></script>
</head>

<body data-page="contact" style="padding-top:140px;">
  <!-- Navbar -->
  <nav class="navbar">
    <div class="logo-container">
      <a href="index.html"><img src="assets/CLS_Nav_Logo.png" alt="CLS Logo" class="logo"></a>
      <a href="index.html" class="company-name">Carolina Lumper Service</a>
    </div>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="about.html">About Us</a></li>
      <li><a href="services.html">Services</a></li>
      <li><a href="contact.html" class="active">Contact</a></li>
      <li><a href="apply.html">Apply</a></li>
    </ul>
  </nav>

  <!-- Hero -->
  <header class="hero">
    <div class="hero-content text-center container">
      <h2>Request a Quote</h2>
      <p>We’re here to assist you with pricing, scheduling, or service inquiries. Let’s connect!</p>
    </div>
    <div class="hero-image">
      <img src="assets/CLS-Cover-01web.webp" alt="Hero Banner" class="banner-image">
      <div class="blur-overlay"></div>
    </div>
  </header>

  <!-- Main -->
  <main class="container">
    <!-- Contact Info -->
    <section id="contact-info" class="section-container">
      <h2>Get in Touch</h2>
      <p>Email us at <a href="mailto:info@carolinalumpers.com">info@carolinalumpers.com</a> or call <a href="tel:+18287810002">(828) 781-0002</a>.</p>
      <p><strong>Business Hours:</strong></p>
      <ul>
        <li>Mon–Fri: 8:00 AM – 6:00 PM</li>
        <li>Sat: 9:00 AM – 3:00 PM</li>
        <li>Sun: Closed</li>
      </ul>
    </section>

    <!-- Quote Request Wizard -->
    <div class="wrap">
      <div class="card" id="wizard">
        <div class="progress" aria-live="polite">
          <div class="progress-top">
            <strong id="stepLabel">Step 1 of 7</strong>
            <span id="stepName">Contact Information</span>
          </div>
          <div class="bar"><div class="bar-fill" id="barFill"></div></div>
          <div class="steps" id="stepsDots"></div>
        </div>

        <!-- Form -->
        <form id="quoteForm" novalidate>
          <!-- Sections identical to your original; unchanged for brevity -->
          <!-- ✅ All your 7 form-step sections remain the same here -->
        </form>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer>
    <p>© 2024 Carolina Lumper Service. All rights reserved.</p>
    <div class="footer-icons">
      <a href="https://www.facebook.com/profile.php?id=61569872795390"><img src="assets/facebook-icon.png" alt="Facebook"></a>
      <a href="#"><img src="assets/linkedin-icon.png" alt="LinkedIn"></a>
    </div>
  </footer>

  <!-- Form Logic -->
  <script>
  (function(){
    const form = document.getElementById('quoteForm');
    const steps = Array.from(form.querySelectorAll('.form-step'));
    const stepLabel = document.getElementById('stepLabel');
    const stepName = document.getElementById('stepName');
    const barFill = document.getElementById('barFill');
    const backBtn = document.getElementById('backBtn');
    const nextBtn = document.getElementById('nextBtn');
    const submitBtn = document.getElementById('submitBtn');
    const successMsg = document.getElementById('successMsg');
    const summaryList = document.getElementById('summaryList');
    const stepsDots = document.getElementById('stepsDots');
    const saveDraftBtn = document.getElementById('saveDraftBtn');

    let current = 0;
    const total = steps.length;

    const titles = steps.map(s => s.dataset.title || 'Step');
    titles.forEach((t,i)=>{
      const dot=document.createElement('button');
      dot.type='button';
      dot.className='step-dot';
      dot.textContent=(i+1);
      dot.title=t;
      dot.addEventListener('click',()=>go(i,true));
      stepsDots.appendChild(dot);
    });

    function updateProgress(){
      stepLabel.textContent = `Step ${current+1} of ${total}`;
      stepName.textContent = titles[current];
      barFill.style.transform = `scaleX(${(current+1)/total})`;
      stepsDots.querySelectorAll('.step-dot').forEach((d,i)=>{
        d.setAttribute('aria-current', i===current ? 'step' : 'false');
        d.classList.toggle('done', i<current);
      });
      backBtn.style.visibility = current === 0 ? 'hidden' : 'visible';
      nextBtn.style.display = current === total-1 ? 'none' : 'inline-flex';
      submitBtn.style.display = current === total-1 ? 'inline-flex' : 'none';
    }

    function go(n, skip=false){
      if (!skip && n>current && !validateStep(current)) return;
      steps[current].classList.remove('active');
      current = Math.max(0, Math.min(total-1,n));
      steps[current].classList.add('active');
      if (current === total-1) buildSummary();
      updateProgress();
      document.querySelector('.card').scrollIntoView({behavior:'smooth'});
    }

    function next(){ go(current+1); }
    function back(){ go(current-1,true); }

    function validateEmail(v){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v); }
    function validateStep(idx){
      const stepEl = steps[idx];
      const fields = stepEl.querySelectorAll('.field');
      fields.forEach(f=>f.classList.remove('invalid'));
      let ok = true;

      if (idx===0){
        const phone = stepEl.querySelector('input[name="phone"]');
        const email = stepEl.querySelector('input[name="email"]');
        if (!phone.value.trim()) { phone.parentElement.classList.add('invalid'); ok=false; }
        if (!validateEmail(email.value)) { email.parentElement.classList.add('invalid'); ok=false; }
      }
      if (idx===2){
        const facility = stepEl.querySelector('input[name="facility"]');
        const address = stepEl.querySelector('input[name="address"]');
        if (!facility.value.trim()) { facility.parentElement.classList.add('invalid'); ok=false; }
        if (!address.value.trim()) { address.parentElement.classList.add('invalid'); ok=false; }
      }
      return ok;
    }

    function getAllValues(){
      const fd = new FormData(form);
      const services = Array.from(form.querySelectorAll('input[name="services"]:checked')).map(i=>i.value);
      if (services.length) fd.set('services', services.join(', '));
      return { fd };
    }

    async function submitForm(e){
      e.preventDefault();
      if (!validateStep(current)) return;

      const { fd } = getAllValues();
      fd.append('startedAt', Date.now());
      fd.append('formType', 'quote-request');

      try {
        const API_BASE = "https://script.google.com/a/macros/carolinalumpers.com/s/AKfycbwWsIE5HwHzfZX2V6kh8SvUXZMhthPeEY3I1p0oGbdU3tp3-T6Q7tgEEgLJ-p9VZu1o/exec";
        const res = await fetch(API_BASE, { method:'POST', body: fd });
        if (res.ok) {
          successMsg.classList.add('show');
          submitBtn.disabled = true;
          nextBtn.disabled = true;
          backBtn.disabled = true;
          localStorage.removeItem('CLS_QUOTE_DRAFT');
        } else throw new Error();
      } catch {
        successMsg.textContent = '⚠️ Error submitting request. Please try again.';
        successMsg.classList.add('show');
      }
    }

    document.getElementById('nextBtn').addEventListener('click', next);
    document.getElementById('backBtn').addEventListener('click', back);
    document.getElementById('quoteForm').addEventListener('submit', submitForm);

    steps[0].classList.add('active');
    updateProgress();
  })();
  </script>
</body>
</html>
